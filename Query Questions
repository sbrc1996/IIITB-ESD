--QUERY TO PRINT THE EMPLOYEE HAVING SALARY EQUAL TO THE AVERAGE SALARY AND HAVING DEPENDENTS. (SOLVE USING CTE)



WITH CTE_NO_DEPENDENTS AS (SELECT ESSN, COUNT(*) AS NO_OF_DEPENDENTS FROM DEPENDENT GROUP BY ESSN),	
  CTE_AVG_SALARY AS (SELECT DNO, AVG(SALARY) AS AVGSAL FROM EMPLOYEE GROUP BY DNO)

SELECT E.SSN, E.FNAME, E.MINIT, E.LNAME, E.SALARY, A.AVGSAL,  B.NO_OF_DEPENDENTS
FROM EMPLOYEE E 
INNER JOIN CTE_AVG_SALARY A
ON E.DNO = A.DNO
INNER JOIN CTE_NO_DEPENDENTS B
ON E.SSN = B.ESSN;




